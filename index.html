<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <title>千与千寻</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Ubuntu:wght@300;400;500;700&display=swap');
        body {
            /* background-color: #FFF5E6; */
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }

        .watermark-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 0;
            pointer-events: none;
        }
        
        .watermark {
            position: absolute;
            font-size: 3rem;
            font-weight: 800;
            color: rgba(0, 0, 0, 0.07);
            animation: float 25s infinite ease-in-out;
            user-select: none;
            padding: 10px;
        }
        
        .version-info {
            position: fixed;
            left: 50%;
            bottom: 10px;
            font-size: 14px;
            color: #666;
        }

        .container {
            margin: 15px 15px 15px 15px; /*上 右 下 左*/
            padding: 10px;
            background: rgba(55, 37, 37, 0.055);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            min-height: calc(100vh - 30px - 30px); /* 减去上下外边距总和 66px */
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .player-container {
            margin: 90px;
            width: 1300px;
            height: 700px;
            /* background: rgba(63, 18, 18, 0.668); */
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 24px;
            border-radius: 10px;
            position: relative; /* 添加相对定位 */
        }

        .music {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            position: relative; /* 添加相对定位 */
            height: 100%; /* 确保填充整个容器 */
            width: 100%; /* 确保填充整个容器 */
        }

        .title {
            font-weight: 400;
            font-size: 2em;
            color: #38a7ff;
            display: inline-flex;
            text-align: center;
            margin-bottom: 20px;
        }
        
        /* 新增 detail-container 样式 */
        .detail-container {
            position: relative;
            top: -15px;
            width: 1200px;
            margin: 0 5px 0px 5px; /* 上 右 下 左 - 底部5px间距 */
            height: 550px;
            padding: 0px;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            text-align: center;
            z-index: 5;
            box-shadow: -10px -10px 15px #fff,
                        10px 10px 15px rgba(0, 0, 0, 0.1),
                        inset -5px -5px 15px #fff,
                        inset 5px 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .detail-container span {
            font-size: 1.2em;
            color: #555;
            display: block;
            margin-bottom: 10px;
        }
        .language-en {
            position: relative;
            margin: 10px 10px 10px 25px; /* 上 右 下 左 - 底部5px间距 */
            height: 450px;
            width: 1150px;
            border-radius: 10px;
            /* background-color: #a0474745; */
        }

        /* 分割线样式 */
        .language-line {
            width: 1150px;
            margin: 0px 10px 0px 25px;
            height: 3px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            cursor: pointer;
        }

        .language-zh {
            position: relative;
            margin: 10px 10px 10px 25px; /* 上 右 下 左 - 底部5px间距 */
            height: 65px;
            width: 1150px;
            border-radius: 10px;
            /* background-color: #a0474745; */
        }
        
        .player {
            position: relative;
            width: 600px;
            min-height: 50px;
            background: #fbfbfb;
            border: 2px solid #fff;
            border-radius: 80px;
            padding: 20px 30px;
            box-shadow: -10px -10px 15px #fff,
                        10px 10px 15px rgba(0, 0, 0, 0.1),
                        inset -5px -5px 15px #fff,
                        inset 5px 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 5px; /* 减少底部间距到5px */
            transform: translateY(1px); /* 播放器的位置高度 */
        }
        .btns {
            position: relative;
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }
        .btns span {
            position: relative;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #777;
            box-shadow: inset 0 -5px 5px rgba(0,0,0,0.1),
                        0 5px 10px rgba(0,0,0,0.1),
                        0 10px 15px rgba(0,0,0,0.1);
            cursor: pointer;
        }
        .btns span:active {
            color: #ff669a;
            box-shadow: inset 0 -7px 5px rgba(0,0,0,0.025),
                        inset 0 5px 10px rgba(0,0,0,0.1);
        }
        .btns span:active,
        .btns span.active {
            color: #ff669a;
            box-shadow: inset 0 -7px 5px rgba(0, 0, 0, 0.025),
                inset 0 5px 10px rgba(0, 0, 0, 0.15);
        }
        .btns span.playPause {
            width: 60px;
            height: 60px;
        }

        .btns span ion-icon {
            font-size: 1.5em;
        }

        .btns span.playPause ion-icon {
            font-size: 2em;
        }

        /* 修改进度条容器样式 - 使用绝对定位靠近底部 */
        .progress-all {
            position: absolute;
            bottom: 0px; /* 距离底部40px */
            left: 50%;
            transform: translateX(-50%);
            width: 588px;
        }
        
        /* 新增进度条样式 */
        .progress-container {
            width: 100%;
            height: 6px;
            background: #e0e0e0;
            border-radius: 10px;
            margin-top: 20px;
            overflow: hidden;
            cursor: pointer;
        }
        
        .progress {
            height: 100%;
            background: #38a7ff;
            width: 0%;
            border-radius: 10px;
            transition: width 0.1s ease;
        }

        .time-display {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
            color: #777;
            font-size: 14px;
        }

        /* 修改语言按钮样式 */
        .language-btn {
            position: absolute;
            top: -11px;
            left: 15px;
            min-width: 10px;
            height: 22px;
            border-radius: 15px;
            background: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #777;
            box-shadow: inset 0 -5px 5px rgba(0,0,0,0.1),
                        0 5px 10px rgba(0,0,0,0.1),
                        0 10px 15px rgba(0,0,0,0.1);
            cursor: pointer;
            z-index: 10;
            transition: all 0.3s ease;
            padding: 0 10px;
            gap: 5px;
        }

        .language-btn:hover {
            color: #38a7ff;
            transform: scale(1.05);
        }

        .language-btn:active {
            color: #ff669a;
            box-shadow: inset 0 -7px 5px rgba(0,0,0,0.025),
                        inset 0 5px 10px rgba(0,0,0,0.1);
        }

        .language-btn ion-icon {
            font-size: 0.9em;
        }
        
        .language-text {
            font-size: 0.8em;
            font-weight: 500;
        }

        /* 播放模式按钮样式 */
        .play-model {
            position: relative;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #777;
            box-shadow: inset 0 -5px 5px rgba(0,0,0,0.1),
                        0 5px 10px rgba(0,0,0,0.1),
                        0 10px 15px rgba(0,0,0,0.1);
            cursor: pointer;
        }
        
        .play-model ion-icon {
            position: absolute;
            transition: opacity 0.3s ease;
        }
        
        .play-model .icon-hidden {
            opacity: 0;
        }

        /* 新增帮助按钮样式 */
        .help-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #777;
            box-shadow: inset 0 -5px 5px rgba(0,0,0,0.1),
                        0 5px 10px rgba(0,0,0,0.1),
                        0 10px 15px rgba(0,0,0,0.1);
            cursor: pointer;
            z-index: 10;
            transition: all 0.3s ease;
        }

        .help-btn:hover {
            color: #38a7ff;
            transform: scale(1.1);
        }

        .help-btn:active {
            color: #ff669a;
            box-shadow: inset 0 -7px 5px rgba(0,0,0,0.025),
                        inset 0 5px 10px rgba(0,0,0,0.1);
        }

        .help-btn ion-icon {
            font-size: 1.5em;
        }

        /* 新增详细信息按钮样式 */
        .detail-btn {
            position: absolute;
            top: 39px;
            right: 5px; /* 放在帮助按钮左侧 */
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #777;
            box-shadow: inset 0 -5px 5px rgba(0,0,0,0.1),
                        0 5px 10px rgba(0,0,0,0.1),
                        0 10px 15px rgba(0,0,0,0.1);
            cursor: pointer;
            z-index: 10;
            transition: all 0.3s ease;
        }

        .detail-btn:hover {
            color: #38a7ff;
            transform: scale(1.1);
        }

        .detail-btn:active {
            color: #ff669a;
            box-shadow: inset 0 -7px 5px rgba(0,0,0,0.025),
                        inset 0 5px 10px rgba(0,0,0,0.1);
        }

        .detail-btn ion-icon {
            font-size: 1.5em;
        }

    </style>
</head>
<body>
    <div class="container">
        <div class="watermark-container" id="watermarkContainer"></div>
        <div class="player-container">
            <!-- 添加详细信息按钮 -->
            <div class="detail-btn" id="detailBtn">
                <ion-icon name="color-wand-outline"></ion-icon>
            </div>
            
            <!-- 添加帮助按钮 -->
            <div class="help-btn" id="helpBtn">
                <ion-icon name="help-circle-outline"></ion-icon>
            </div>

            <div class="music">
                <div class="detail-container">
                    <div class="language-en">
                        En:<h2 class="title"></h2>
                        <span>
                            分析图表 原文, 成分
                        </span>
                    </div>
                    <div class="language-line">
                    </div>
                    <div class="language-zh">
                        中文asd 
                    </div>
                </div>

                <div class="player">
                    <!-- 修改语言按钮 -->
                    <div class="language-btn" id="languageBtn">
                        <span class="language-text">en</span>
                    </div>
                    
                    <audio src=""></audio>
                    <div class="btns">
                        <span class="play-model" id="playModeBtn">
                            <ion-icon name="remove-outline" data-mode="single" ></ion-icon>
                            <ion-icon name="sync-outline" data-mode="single-loop" class="icon-hidden"></ion-icon>
                            <ion-icon name="reorder-three-outline" data-mode="list" class="icon-hidden"></ion-icon>
                            <ion-icon name="sync-outline" data-mode="list-loop" class="icon-hidden"></ion-icon>
                        </span>

                        <span class="prev">
                            <ion-icon name="play-back-outline"></ion-icon>
                        </span>

                        <span class="playPause">
                            <ion-icon name="play-outline"></ion-icon>
                        </span>
                        
                        <span class="next">
                            <ion-icon name="play-forward-outline"></ion-icon>
                        </span>

                        <!-- 台词列表 -->
                        <span class="lines-list">
                            <ion-icon name="list-outline"></ion-icon>
                        </span>
                    </div>
                </div>
                <!-- 进度条现在使用绝对定位靠近底部 -->
                <div class="progress-all">
                    <!-- 新增进度条 -->
                    <div class="progress-container">
                        <div class="progress"></div>
                    </div>
                    <div class="time-display">
                        <span class="current-time">0:00</span>
                        <span class="duration">0:00</span>
                    </div>
                </div>
            </div>
        </div>
        <!-- 更新版本号 -->
        <div class="version-info">v.0.0.9</div>
    </div>
</body>
<script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
<script>
    const title = document.querySelector('.title');
    const prev = document.querySelector('.prev');
    const playPause = document.querySelector('.playPause');
    const next = document.querySelector('.next');
    const audio = document.querySelector('audio');
    const progressContainer = document.querySelector('.progress-container');
    const progress = document.querySelector('.progress');
    const currentTimeEl = document.querySelector('.current-time');
    const durationEl = document.querySelector('.duration');
    const languageBtn = document.getElementById('languageBtn');
    const languageText = languageBtn.querySelector('.language-text');
    const playModeBtn = document.getElementById('playModeBtn');
    const playModeIcons = playModeBtn.querySelectorAll('ion-icon');
    const helpBtn = document.getElementById('helpBtn');
    const detailBtn = document.getElementById('detailBtn'); // 获取详细信息按钮
    
    // 语言选项和状态
    const languageOptions = ['en', 'zh', 'en,zh'];
    let currentLanguageIndex = 0;
    
    // 播放模式选项和状态
    const playModes = ['single', 'single-loop', 'list', 'list-loop'];
    let currentPlayModeIndex = 0;
    
    // 切换语言函数
    function toggleLanguage() {
        currentLanguageIndex = (currentLanguageIndex + 1) % languageOptions.length;
        languageText.textContent = languageOptions[currentLanguageIndex];
        
        // 可以根据选择的语言执行相应操作
        console.log('Language changed to:', languageOptions[currentLanguageIndex]);
    }
    
    // 切换播放模式函数
    function togglePlayMode() {
        // 隐藏所有图标
        playModeIcons.forEach(icon => icon.classList.add('icon-hidden'));
        
        // 更新模式索引
        currentPlayModeIndex = (currentPlayModeIndex + 1) % playModes.length;
        
        // 显示当前模式的图标
        const currentMode = playModes[currentPlayModeIndex];
        const currentIcon = Array.from(playModeIcons).find(icon => icon.getAttribute('data-mode') === currentMode);
        if (currentIcon) {
            currentIcon.classList.remove('icon-hidden');
            if (currentMode === 'single-loop') {
                let icon = Array.from(playModeIcons).find(icon => icon.getAttribute('data-mode') === 'single');
                icon.classList.remove('icon-hidden');
            } else if (currentMode === 'list-loop' ) {
                let icon = Array.from(playModeIcons).find(icon => icon.getAttribute('data-mode') === 'list');
                icon.classList.remove('icon-hidden');
            }
        }
        
        // 可以根据选择的播放模式执行相应操作
        console.log('Play mode changed to:', currentMode);
        
        // 更新播放模式的实际功能
        updatePlayMode(currentMode);
    }
    
    // 更新播放模式的实际功能
    function updatePlayMode(mode) {
        switch(mode) {
            case 'single':
                // 单曲播放一次
                audio.loop = false;
                break;
            case 'single-loop':
                // 单曲循环
                audio.loop = false;
                break;
            case 'list':
                // 列表播放一次
                audio.loop = false;
                break;
            case 'list-loop':
                // 列表循环
                audio.loop = true;
                break;
        }
    }
    
    // 帮助按钮点击事件
    function showHelp() {
        alert('这里是帮助信息\n\n播放器功能说明：\n- 播放/暂停：控制音乐播放\n- 上一曲/下一曲：切换歌曲\n- 语言切换：更改界面语言\n- 播放模式：选择不同的播放循环方式');
    }
    
    // 详细信息按钮点击事件
    function showDetails() {
        const currentSong = songList[currentSongIndex];
        alert(`歌曲详细信息：\n\n歌曲名称：${currentSong.songName}\n文件路径：${currentSong.path}\n当前播放模式：${playModes[currentPlayModeIndex]}\n当前语言：${languageOptions[currentLanguageIndex]}`);
    }
    
    // 添加语言切换事件
    languageBtn.addEventListener('click', toggleLanguage);
    
    // 添加播放模式切换事件
    playModeBtn.addEventListener('click', togglePlayMode);
    
    // 添加帮助按钮点击事件
    helpBtn.addEventListener('click', showHelp);
    
    // 添加详细信息按钮点击事件
    detailBtn.addEventListener('click', showDetails);
    
    //first,we will create song list
    const songList = [
        {
            path: "./music/1.mp3",
            songName: "name 1",
        },
        {
            path: "./music/2.mp3",
            songName: "name 2",
        },
        {
            path: "./music/3.mp3",
            songName: "name 3",
        },
        {
            path: "./music/4.mp3",
            songName: "name 4",
        },
        {
            path: "./music/5.mp3",
            songName: "name 5",
        }
    ];
    let song_Playing = false;
    let currentSongIndex = 0;

    // 加载歌曲
    function loadSong(song) {
        title.textContent = song.songName;
        audio.src = song.path;

        // 重置进度条
        progress.style.width = '0%';
        currentTimeEl.textContent = '0:00';

        // 当元数据加载完成后更新总时长
        audio.addEventListener('loadedmetadata', function() {
            const duration = audio.duration;
            const minutes = Math.floor(duration / 60);
            const seconds = Math.floor(duration % 60);
            durationEl.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
        });
    }

    //play song
    function playSong(){
        song_Playing = true;
        audio.play();
        playPause.classList.add('active');
        //change icon
        playPause.innerHTML = '<ion-icon name="pause-outline"></ion-icon>';
    }

    //pause song
    function pauseSong(){
        song_Playing = false;
        audio.pause();
        playPause.classList.remove('active');
        //change icon
        playPause.innerHTML = '<ion-icon name="play-outline"></ion-icon>';
    }

    //play or pause song on click
    playPause.addEventListener("click", () => (song_Playing ? pauseSong() : playSong()));

    //next song

    function prevSong(){
        currentSongIndex--;
        if (currentSongIndex < 0 ){
            currentSongIndex = songList.length - 1;
        }
        loadSong(songList[currentSongIndex]);
        playSong();
    }
    prev.addEventListener("click", prevSong);

    function nextSong(){
        currentSongIndex++;
        if (currentSongIndex > songList.length - 1){
            currentSongIndex = 0;
        }
        loadSong(songList[currentSongIndex]);
        playSong();
    }
    next.addEventListener("click", nextSong);

    // 更新进度条
    function updateProgress(e) {
        const { duration, currentTime } = e.srcElement;
        if (duration) {
            const progressPercent = (currentTime / duration) * 100;
            progress.style.width = `${progressPercent}%`;
            
            // 更新当前时间显示
            const currentMinutes = Math.floor(currentTime / 60);
            const currentSeconds = Math.floor(currentTime % 60);
            currentTimeEl.textContent = `${currentMinutes}:${currentSeconds < 10 ? '0' : ''}${currentSeconds}`;
        }
    }
    
    // 设置进度条
    function setProgress(e) {
        const width = this.clientWidth;
        const clickX = e.offsetX;
        const duration = audio.duration;
        audio.currentTime = (clickX / width) * duration;
    }

    // 事件监听
    audio.addEventListener('timeupdate', updateProgress);
    audio.addEventListener('ended', nextSong); // 歌曲结束时自动播放下一首
    progressContainer.addEventListener('click', setProgress);

    // 初始化加载第一首歌
    loadSong(songList[currentSongIndex]);

    document.addEventListener('DOMContentLoaded', function() {
            const container = document.getElementById('watermarkContainer');
            const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
            let density = 77; // 中等密度
            let placedLetters = []; // 存储已放置字母的信息
            
            // 创建水印
            function createWatermarks() {
                container.innerHTML = '';
                placedLetters = [];
                const { width, height } = container.getBoundingClientRect();
                const maxAttempts = 100; // 每个字母的最大尝试次数
                
                for (let i = 0; i < density; i++) {
                    const watermark = document.createElement('div');
                    watermark.className = 'watermark';
                    const letter = letters[Math.floor(Math.random() * letters.length)];
                    watermark.textContent = letter;
                    
                    // 随机大小
                    const size = Math.random() * 7;
                    watermark.style.fontSize = `${size}rem`;
                    
                    // 随机旋转
                    const rotate = Math.random() * 30 - 15;
                    watermark.style.transform = `rotate(${rotate}deg)`;
                    
                    // 随机动画延迟
                    const delay = Math.random() * 20;
                    watermark.style.animationDelay = `${delay}s`;
                                        
                    // 估算字母尺寸（添加边距）
                    const letterWidth = size * 20 + 40; // 近似宽度
                    const letterHeight = size * 20 + 40; // 近似高度
                    
                    // 尝试找到不重叠的位置
                    let placed = false;
                    let attempts = 0;
                    
                    while (!placed && attempts < maxAttempts) {
                        attempts++;
                        
                        // 随机位置
                        const left = Math.random() * (width - letterWidth);
                        const top = Math.random() * (height - letterHeight);
                        
                        // 检查是否与已放置字母重叠
                        const overlaps = checkOverlap(left, top, letterWidth, letterHeight);
                        
                        if (!overlaps) {
                            // 位置有效，放置字母
                            watermark.style.left = `${left}px`;
                            watermark.style.top = `${top}px`;
                            container.appendChild(watermark);
                            
                            // 存储字母信息用于后续碰撞检测
                            placedLetters.push({
                                left,
                                top,
                                right: left + letterWidth,
                                bottom: top + letterHeight
                            });
                            
                            placed = true;
                        }
                    }
                    
                    // 如果尝试多次仍找不到位置，跳过这个字母
                    if (!placed) {
                        console.log(`无法放置字母 ${letter}，跳过`);
                    }
                }
            }
            
            // 检查是否与已放置字母重叠
            function checkOverlap(left, top, width, height) {
                const right = left + width;
                const bottom = top + height;
                
                // 检查边界
                if (right > container.clientWidth || bottom > container.clientHeight) {
                    return true;
                }
                
                // 检查与已放置字母的重叠
                for (const placed of placedLetters) {
                    if (!(right < placed.left || 
                          left > placed.right || 
                          bottom < placed.top || 
                          top > placed.bottom)) {
                        return true; // 重叠
                    }
                }
                
                return false; // 不重叠
            }
            
            // 初始化水印
            createWatermarks();
            
            // 调整窗口大小时重新创建水印
            window.addEventListener('resize', createWatermarks);
        });
</script>
</html>